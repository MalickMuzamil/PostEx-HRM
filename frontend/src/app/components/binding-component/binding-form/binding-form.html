<div class="d-flex justify-content-between align-items-center mb-3">
  <h5>{{ editData ? 'Edit Hierarchy' : 'Add New Hierarchy' }}</h5>

  <div class="form-check form-switch">
    <input class="form-check-input" type="checkbox" [(ngModel)]="isActive">
    <label class="form-check-label">Active</label>
  </div>
</div>

<!-- MAIN TABLE -->
<table class="table table-sm table-bordered">
  <thead class="table-dark">
    <tr>
      <th>Level</th>
      <th>Type</th>
      <th>Node</th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let row of rows; let i = index">
      <td>{{ i + 1 }}</td>

      <!-- TYPE DROPDOWN -->
      <td>
        <select class="form-select form-select-sm" [(ngModel)]="row.type_id" (ngModelChange)="onRowChange(i)">
          <option value="">Select...</option>
          <option *ngFor="let t of getAvailableTypes(i)" [ngValue]="t.type_id">
            {{ t.type_name }}
          </option>
        </select>
      </td>

      <!-- NODE DROPDOWN -->
      <td>
        <select class="form-select form-select-sm" [(ngModel)]="row.node_id" (ngModelChange)="onRowChange(i)">
          <option value="">Select...</option>
          <option *ngFor="let n of getNodesForRow(row.type_id)" [ngValue]="n.node_id">
            {{ n.node_name }} ({{ n.type_name }})
          </option>
        </select>
      </td>
    </tr>
  </tbody>
</table>

<!-- DATE SECTION -->
<div class="row mt-3">
  <div class="col-md-4">
    <label>Effective From *</label>
    <input type="date" class="form-control" [(ngModel)]="effective_from" [min]="tomorrow">
  </div>

  <div class="col-md-4">
    <label>Effective To</label>
    <input type="date" class="form-control" [(ngModel)]="effective_to" [min]="effective_from || tomorrow">
  </div>
</div>

<div class="mt-3 d-flex justify-content-end">
  <button class="btn btn-primary me-2" (click)="save()" [disabled]="editData && !hasChanges()">
    Save
  </button>

  <button class="btn btn-secondary" (click)="cancel()">Cancel</button>
</div>